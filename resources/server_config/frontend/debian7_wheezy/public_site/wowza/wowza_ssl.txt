Wowza tanúsítványok

Miért kell?
RTMPS
HTTPS alapú streamingek

Certificate Signing Request (CSR)

Generálás
Példa: stream2.videosquare.eu

# cd /usr/local/WowzaMediaServer/conf/
# keytool -genkey -keysize 2048 -alias wowza -keyalg RSA -keystore stream2.videosquare.eu.jks
Enter keystore password:
Re-enter new password:
What is your first and last name?
  [Unknown]:  stream2.videosquare.eu
What is the name of your organizational unit?
  [Unknown]:
What is the name of your organization?
  [Unknown]:  Videosquare Ltd.
What is the name of your City or Locality?
  [Unknown]:  Budapest
What is the name of your State or Province?
  [Unknown]:
What is the two-letter country code for this unit?
  [Unknown]:  HU
Is CN=stream2.videosquare.eu, OU=Unknown, O=Videosquare Ltd., L=Budapest, ST=Unknown, C=HU correct?
  [no]:  yes

Enter key password for <wowza>
        (RETURN if same as keystore password):

Keystore jelszó:

kiskakukk123

CSR file generálása:

keytool -certreq -file stream2.videosquare.eu.csr -alias wowza -keyalg RSA -keystore stream2.videosquare.eu.jks

Eredmény: /usr/local/WowzaMediaServer/conf/stream2.videosquare.eu.csr (PEM-encoded certificate request)
Submitting the CSR to a Certificate Authority
Certificate Authority függõ (ld. dokumentáció). A StartSSL-nél be kell másolni egy web formba a CSR-t.
Importálás
StartSSL:
root CA certificate-t kell letölteni PEM formátumban (ca.pem).
intermediate certificate-t szintén le kell tölteni
Root cert install:

keytool -import -alias root -trustcacerts -file ca.pem -keystore stream2.videosquare.eu.jks

Intermediate cert install:

keytool -import -trustcacerts -alias intermediate -file sub.class1.server.ca.pem -keystore stream2.videosquare.eu.jks

A CA által számunkra kiállított certificate betöltése a keystore-ba:

keytool -import -alias wowza -trustcacerts -file stream2.videosquare.eu.startssl.cert -keystore stream2.videosquare.eu.jks

Wowza oldali konfiguráció
Megjegyzés: Wowza Stream Engine 4.x-hez is jó a leírás, azonban a web GUI-ról simán hozzáadható HostPort, azt kell használni.
/conf/VHost.xml:
Uncomment the <HostPort> definition for port 443. This entry follows the comment . Be sure to remove the comment before <HostPort> and after </HostPort>.
Az IP cím helyett a teljes hostname-t tegyük be:

<IpAddress>stream2.videosquare.eu</IpAddress>

Set the value SSLConfig/KeyStorePath to:
${com.wowza.wms.context.VHostConfigHome}/keys/stream2.videosquare.eu.jks
Set the SSLConfig/KeyStorePassword to the key store password entered above.
Adobe HDS
Using a text editor, edit [install-dir]/conf/crossdomain.xml and change the <allow-access-from> line to <allow-access-from domain="*" secure="false" />. The modified contents should look like the following:

<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
	<allow-access-from domain="*" secure="false" />
	<site-control permitted-cross-domain-policies="all"/>
</cross-domain-policy>

Példa URL:

https://stream2.videosquare.eu:443/devvsq/_definst_/mp4:19/19/19_video_lq.mp4/manifest.f4m