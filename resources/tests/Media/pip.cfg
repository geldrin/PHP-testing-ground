# VideoLAN VLM config file
# TARGET: picture-in-picture content + video conversion

del all

# Background video (large)
new channel1 broadcast
setup channel1 input andor_agnes.mp4
setup channel1 output #duplicate{dst=mosaic-bridge{id=1,width=424,height=320},select=video,dst=bridge-out{id=1},select=audio}
setup channel1 enabled

# Picture in picture video (small)
new channel2 broadcast
setup channel2 input andor_agnes.mp4
setup channel2 output #duplicate{dst=mosaic-bridge{id=2,width=80,height=40},select=video,dst=bridge-out{id=2},select=audio}
setup channel2 enabled

# Background video
new bg broadcast enabled
setup bg input black.png
setup bg option image-width=424
setup bg option image-height=320
setup bg option image-fps=30.0
setup bg option image-duration=-1
setup bg output #transcode{sfilter=mosaic{delay=0},venc=x264{profile=baseline},width=424,height=320,vb=245,acodec=mp3,ab=32,channels=1,samplerate=,scale=1}:bridge-in{delay=0,id-offset=100}:standard{access=file,mux=mp4,dst=pip_output.mp4}

# Play inputs and background
control channel1 play
control channel2 play
control bg play